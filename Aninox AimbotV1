------------------------------------------------------------
-- SERVICES
------------------------------------------------------------
local UserInputService = game:GetService("UserInputService")

------------------------------------------------------------
-- STATE
------------------------------------------------------------
local Aimbot
local enabled = false
local destroyed = false
local inputConnection

------------------------------------------------------------
-- LOAD
------------------------------------------------------------
local function loadAimbot()
	if Aimbot then return end

	local ok, lib = pcall(function()
		return loadstring(game:HttpGet(
			"https://raw.githubusercontent.com/Exunys/Aimbot-V3/main/src/Aimbot.lua"
		))()
	end)

	if ok and lib then
		Aimbot = lib
		Aimbot.Load()
		if Aimbot.Settings then
			Aimbot.Settings.Enabled = enabled
		end
	end
end

------------------------------------------------------------
-- UNLOAD (PANIC)
------------------------------------------------------------
local function unloadAimbot()
	if not Aimbot then return end

	if Aimbot.Settings then
		Aimbot.Settings.Enabled = false
		Aimbot.Settings.ShowFOV = false
	end

	Aimbot = nil
	destroyed = true
end

------------------------------------------------------------
-- INPUT
------------------------------------------------------------
inputConnection = UserInputService.InputBegan:Connect(function(input, gp)
	if gp then return end

	-- Toggle Aimbot
	if input.KeyCode == Enum.KeyCode.P then
		if destroyed then return end
		enabled = not enabled
		if not Aimbot then loadAimbot() end
		if Aimbot and Aimbot.Settings then
			Aimbot.Settings.Enabled = enabled
		end
	end

	-- Panic Disable (re-execute to restore)
	if input.KeyCode == Enum.KeyCode.M then
		unloadAimbot()
	end
end)

------------------------------------------------------------
-- SILENCE OUTPUT
------------------------------------------------------------
print = function() end
warn  = function() end
error = function() end
